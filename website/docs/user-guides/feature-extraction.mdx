---
id: feature-extraction
title: Extraction des features
sidebar_label: Extraction des features
---


import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'
import { faWandSparkles, faSearchLocation, faMagic, faFileExport } from '@fortawesome/free-solid-svg-icons'
import Admonition from '@theme/Admonition';

# <FontAwesomeIcon icon={faFileExport} /> Guide : Extraction des Features

Cette √©tape est le c≈ìur de l'approche "hybride" (physique + ML) du pipeline. Au lieu de donner le spectre brut √† un mod√®le, nous extrayons des informations physiquement pertinentes : la pr√©sence et la position des principales raies spectrales.

Ce processus est g√©r√© par les classes `PeakDetector` et `FeatureEngineer`.


## <FontAwesomeIcon icon={faSearchLocation} /> √âtape 1 : D√©tection des Pics (Raies)

Le module `PeakDetector` est charg√© d'identifier les minima locaux significatifs dans le spectre normalis√©, qui correspondent √† des raies d'absorption.

1.  **Inversion du Flux :** Les raies d'absorption sont des "creux". Pour les trouver avec un algorithme de d√©tection de pics, on inverse le flux (`-flux`). Les creux deviennent des pics.
2.  **D√©tection avec SciPy :** La fonction `scipy.signal.find_peaks` est utilis√©e pour localiser tous les pics qui d√©passent un certain seuil de **pro√©minence**. Ce param√®tre est crucial pour ne garder que les raies significatives et ignorer le bruit.
3.  **Matching avec les Raies Connues :** La liste des pics d√©tect√©s est ensuite compar√©e √† un dictionnaire de raies astrophysiques cibles (HŒ±, HŒ≤, CaII K&H). Pour chaque raie cible, le script cherche s'il existe un pic d√©tect√© √† proximit√© (dans une fen√™tre de tol√©rance, par ex. ¬±30 √Ö).

Le r√©sultat est un dictionnaire qui, pour chaque raie cible, indique la longueur d'onde exacte du pic trouv√©, ou `None` si aucun pic correspondant n'a √©t√© trouv√©.

```python title="Exemple de sortie du PeakDetector"
matched_lines = {
    "HŒ±": 6565.2,
    "HŒ≤": None,
    "CaII K": 3932.8,
    "CaII H": 3969.1
}
```

<Admonition type="info" title="Interpr√©tation">
Dans cet exemple, le spectre pr√©sente bien des raies HŒ± et Calcium, mais pas de raie HŒ≤ d√©tectable (peut-√™tre une √©toile de type tardif ou un spectre bruit√© dans le bleu).
</Admonition>

## <FontAwesomeIcon icon={faMagic} /> √âtape 2 : Construction du Vecteur de Features

Le dictionnaire de raies est informatif, mais pas directement utilisable par un mod√®le de Machine Learning. Le module FeatureEngineer le transforme en un vecteur num√©rique simple.
Logique Actuelle (v0.1.0) : Pr√©sence/Absence

<details>
  <summary>üí° D√©tails sur les Features Binaires</summary> 
  <div>
    <p>Pour chaque raie cible (HŒ±, HŒ≤, CaII K, CaII H), on cr√©e une feature binaire :</p>
    <ul>
      <li><strong>1</strong> si un pic a √©t√© trouv√© (la valeur dans le dictionnaire n'est pas <code>None</code>).</li>
      <li><strong>0</strong> si la raie est absente.</li>
    </ul>
  </div>
</details>

Pour l'exemple ci-dessus, le vecteur de features final serait : [1, 0, 1, 1].
Ce vecteur simple capture la "signature" de base du spectre, qui est d√©j√† tr√®s discriminante pour s√©parer les types spectraux.

``` python title="src/pipeline/feature_engineering.py - Simplifi√©"
def extract_features(self, matched_lines):
    # self.lines = ["HŒ±", "HŒ≤", "CaII K", "CaII H"]
    features = []
    for line_name in self.lines:
        if matched_lines.get(line_name) is not None:
            features.append(1)
        else:
            features.append(0)
    return features
```
<br/>

:::note Pistes d'Am√©lioration Futures
Ceci est la version la plus simple de l'extraction de features. La Roadmap pr√©voit des am√©liorations majeures :
Extraire plus de raies (He II, G-band, TiO...).
Mesurer les propri√©t√©s physiques de chaque raie (FWHM, profondeur, largeur √©quivalente) pour cr√©er des features beaucoup plus riches.
Calculer des ratios entre l'intensit√© de diff√©rentes raies.
:::