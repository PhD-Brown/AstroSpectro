---
id: classifier
title: Classificateur
hide_title: true
sidebar_label: Classifier les donn√©es
---

<!-- Complet for v0.1.0-alpha release -->

import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'
import { faBrain, faFileCode, faObjectGroup, faBook, faSave, faDownload, faExclamationTriangle, faInfoCircle, faProjectDiagram, faQuestionCircle } from '@fortawesome/free-solid-svg-icons'
import Admonition from '@theme/Admonition';

# <FontAwesomeIcon icon={faBrain} /> `classifier.py`

Ce module contient la classe `SpectralClassifier`, qui est le "cerveau" du pipeline. Elle encapsule un mod√®le de Machine Learning pour r√©aliser la classification √† partir des features extraites.

## <FontAwesomeIcon icon={faProjectDiagram} /> Workflow de la Classification

```mermaid
graph LR
    subgraph "Phase d'Entra√Ænement"
        A["Features & Labels<br>(X, y)"] --> B{"train_and_evaluate()"};
        B --> C["Mod√®le Entra√Æn√©<br><i>en m√©moire</i>"];
    end

    subgraph "Utilisation & Persistance"
        C --> D["evaluate()"];
        C --> E["save_model()"];
        E --> F["Mod√®le Sauvegard√©<br><i>(fichier .pkl)</i>"];
    end

    subgraph "Phase de Pr√©diction"
        F --> G["load_model()"];
        G --> H["Nouveaux<br>Features"];
        H --> I["predict()"];
        I --> J["Pr√©dictions"];
    end
```

## <FontAwesomeIcon icon={faObjectGroup} /> Classe SpectralClassifier
> Cette classe fournit une interface simple pour entra√Æner, √©valuer, et g√©rer la persistance d'un mod√®le de classification.
<details>
<summary>D√©tails sur l'instanciation et la configuration</summary>
<div>
- **Description :** Cr√©e une instance du classifieur. Le mod√®le par d√©faut est un <code>RandomForestClassifier</code> de scikit-learn.
<br/>- **Arguments :**
<ul>
<li><code>n_estimators</code> (int, d√©faut: 100) : Le nombre d'arbres dans la for√™t.</li>
<li><code>random_state</code> (int, d√©faut: 42) : Pour garantir la reproductibilit√© des r√©sultats.</li>
</ul>
- **Attributs Notables :**
<ul>
<li><code>class_weight='balanced'</code> : Le mod√®le ajuste automatiquement le poids des classes pour compenser les d√©s√©quilibres dans le jeu de donn√©es.</li>
</ul>
</div>
</details>
## Bonnes Pratiques & Limites
<div className="container" style={{padding: '0'}}>
<div className="row">
<div className="col col--6">
<Admonition type="tip" title="Bonnes Pratiques" icon="üí°">
<ul>
<li>Fixez toujours le <code>random_state</code> pour des exp√©riences reproductibles.</li>
<li>Validez syst√©matiquement les performances sur un jeu de test qui n'a pas servi √† l'entra√Ænement.</li>
<li>Sauvegardez non seulement le mod√®le, mais aussi la version du code et les param√®tres de pr√©traitement pour une tra√ßabilit√© compl√®te.</li>
</ul>
</Admonition>
</div>
<div className="col col--6">
<Admonition type="danger" title="Limites & Cas Limites" icon="‚ò¢Ô∏è">
<ul>
<li>Pour des jeux de donn√©es tr√®s petits, les performances peuvent varier fortement entre deux ex√©cutions.</li>
<li>Random Forest est robuste, mais si vos features sont tr√®s corr√©l√©es, sa performance peut √™tre affect√©e.</li>
<li>Pour des d√©s√©quilibres de classes extr√™mes, explorer des techniques de r√©-√©chantillonnage (ex: SMOTE) en plus de <code>class_weight</code> peut √™tre b√©n√©fique.</li>
</ul>
</Admonition>
</div>
</div>
</div>

## <FontAwesomeIcon icon={faBook} /> M√©thodes Principales

### ``train_and_evaluate(X, y, test_size=0.25)``

> C'est la m√©thode "tout-en-un" pour un workflow standard.

- **R√¥le :** Prend une matrice de features X et un vecteur de labels y, les s√©pare en ensembles d'entra√Ænement/test, entra√Æne le mod√®le, et affiche un rapport d'√©valuation complet.
- **Arguments :``
  - X (array-like) : La matrice des features.
  - y (array-like) : Le vecteur des labels correspondants.
  - test_size (float, d√©faut: 0.25) : La proportion du dataset √† r√©server pour le test.

### ``train(X_train, y_train)``

- **R√¥le :** Entra√Æne le mod√®le uniquement sur les donn√©es fournies. Utile pour des sch√©mas de validation plus complexes (ex: validation crois√©e manuelle).

### ``evaluate(X_test, y_test)``
- **R√¥le :** √âvalue le mod√®le d√©j√† entra√Æn√© sur un jeu de test et affiche le rapport de classification et la matrice de confusion.

## <FontAwesomeIcon icon={faQuestionCircle} /> Questions Fr√©quentes (FAQ)

<details>
<summary>Puis-je utiliser un autre mod√®le que Random Forest ?</summary>
<div>
<p>
<strong>Oui, absolument.</strong> La classe <code>SpectralClassifier</code> a √©t√© con√ßue pour √™tre modulaire. Il vous suffirait de modifier la ligne <code>self.model = RandomForestClassifier(...)</code> dans le constructeur <code>__init__</code> pour utiliser un autre classifieur de scikit-learn (comme <code>SVC</code>, <code>XGBClassifier</code>, etc.), tout en conservant le reste de l'interface (<code>train</code>, <code>evaluate</code>...).
</p>
</div>
</details>
<details>
<summary>Comment utiliser un mod√®le d√©j√† entra√Æn√© pour pr√©dire sur de nouvelles donn√©es ?</summary>
<div>
<p>
C'est exactement le but de <code>save_model</code> et <code>load_model</code>. Le workflow est le suivant :
</p>
<ol>
<li>Chargez le mod√®le avec <code>loaded_clf = SpectralClassifier.load_model("path/to/model.pkl")</code>.</li>
<li>Pr√©parez vos nouvelles donn√©es pour obtenir une matrice de features <code>X_new</code>.</li>
<li>Faites la pr√©diction avec <code>predictions = loaded_clf.model.predict(X_new)</code>.</li>
</ol>
</div>
</details>
<div style={{marginTop: "2rem"}}>
<Admonition type="info" title="Liens & R√©f√©rences Utiles" icon={<FontAwesomeIcon icon={faInfoCircle} />}>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" target="_blank">Documentation de <code>RandomForestClassifier</code></a></li>
<li><a href="https://joblib.readthedocs.io/en/latest/persistence.html" target="_blank">Documentation de <code>Joblib</code> pour la persistance des mod√®les</a></li>
</ul>
</Admonition>
</div>