---
id: classifier
title: Classificateur
hide_title: true
sidebar_label: Classifier les donn√©es
---

<!-- Complet for v1.0.0 release -->

import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'
import { faBrain, faFileCode, faObjectGroup, faBook, faSave, faExclamationTriangle, faInfoCircle, faProjectDiagram, faQuestionCircle } from '@fortawesome/free-solid-svg-icons'
import Admonition from '@theme/Admonition';

# <FontAwesomeIcon icon={faBrain} /> `classifier.py`

Ce module contient la classe [`SpectralClassifier`](https://github.com/PhD-Brown/AstroSpectro/blob/main/src/pipeline/classifier.py), qui est le "cerveau" du pipeline. Elle encapsule un pipeline de Machine Learning complet pour r√©aliser la classification √† partir des *features* extraites.

## <FontAwesomeIcon icon={faProjectDiagram} /> Workflow de la Classification

Le workflow g√©r√© par la classe est beaucoup plus qu'un simple entra√Ænement. Il s'agit d'un processus rigoureux de pr√©paration, d'optimisation et d'√©valuation.

```mermaid
---
config:
  layout: fixed
---
flowchart TD
 subgraph subGraph0["Pr√©paration (dans train_and_evaluate)"]
        B["Nettoyage & Filtrage"]
        A["DataFrame de Features<br><i>(brut)</i>"]
        C["S√©lection des Features"]
        D["Features &amp; Labels<br>(X, y)"]
        E["Train & Test Split"]
  end
 subgraph subGraph1["Pipeline Scikit-learn"]
    direction LR
        P4("Mod√®le")
        P3("SMOTE")
        P2("Scaler")
        P1("Imputer")
  end
 subgraph subGraph2["Entra√Ænement & Tuning"]
        F{"GridSearchCV"}
        subGraph1
  end
 subgraph subGraph3["R√©sultats & Persistance"]
        H("evaluate()")
        G["Meilleur Mod√®le<br><i>(pipeline complet)</i>"]
        I["Rapport & Matrice"]
        J("save_model()")
        K["Mod√®le Sauvegard√©<br><i>(fichier .pkl)</i>"]
  end
    A --> B
    B --> C
    C --> D
    D --> E
    P1 --> P2
    P2 --> P3
    P3 --> P4
    F -- entra√Æne et √©value sur 3 plis --> P4
    G --> H & J
    H --> I
    J --> K
    E -- Donn√©es d'entra√Ænement --> F
    F --> G
     A:::fill:#333,
     I:::fill:#333,
     K:::fill:#333,
    classDef default fill:#222,stroke:#555,stroke-width:2px,color:#fff
```

## <FontAwesomeIcon icon={faObjectGroup} /> Classe ``SpectralClassifier``

> Cette classe fournit une interface de haut niveau pour entra√Æner, optimiser, √©valuer et g√©rer la persistance d'un mod√®le de classification.

<details>
<summary>D√©tails sur l'instanciation et la configuration</summary>
<div>
- **Description :** Cr√©e une instance du classifieur.
- **Arguments :**
- `model_type` (str, d√©faut: 'RandomForest') : Le type de mod√®le √† utiliser. Peut √™tre 'RandomForest' ou 'XGBoost'.
- `random_state` (int, d√©faut: 42) : Pour garantir la reproductibilit√© des r√©sultats.
</div>
</details>

### <FontAwesomeIcon icon={faInfoCircle} /> Bonnes Pratiques & Points Cl√©s

<div className="container" style={{padding: '0'}}>
<div className="row">
<div className="col col--6">
<Admonition type="tip" title="Ce qui est Inclus" icon="üí°">
<ul>
<li><strong>Pipeline Int√©gr√© :</strong> L'utilisation d'un <code>Pipeline</code> garantit que le scaling et l'imputation sont appris uniquement sur les donn√©es d'entra√Ænement, √©vitant les fuites de donn√©es.</li>
<li><strong>Validation Crois√©e :</strong> <code>GridSearchCV</code> utilise une validation crois√©e stratifi√©e pour une √©valuation robuste et un choix de param√®tres fiable.</li>
<li><strong>Gestion du D√©s√©quilibre :</strong> L'√©tape <code>SMOTE</code> est appliqu√©e √† la vol√©e pendant l'entra√Ænement pour corriger le d√©s√©quilibre des classes sans polluer le jeu de test.</li>
</ul>
</Admonition>
</div>
<div className="col col--6">
<Admonition type="danger" title="Ce qui est G√©r√©" icon="‚ò¢Ô∏è">
<ul>
<li><strong>Donn√©es Manquantes :</strong> Les <code>NaN</code> dans les <em>features</em> (ex: FWHM non calculable) sont automatiquement remplac√©s par z√©ro gr√¢ce √† <code>SimpleImputer</code>.</li>
<li><strong>Labels Invalides :</strong> Les spectres sans <code>subclass</code> valide sont automatiquement exclus.</li>
<li><strong>Classes Rares :</strong> Les classes avec moins de 10 √©chantillons sont retir√©es pour garantir la stabilit√© de l'entra√Ænement et de l'√©valuation.</li>
</ul>
</Admonition>
</div>
</div>
</div>

### <FontAwesomeIcon icon={faQuestionCircle} /> Questions Fr√©quentes (FAQ)

<details>
<summary>Comment puis-je utiliser un mod√®le d√©j√† entra√Æn√© pour pr√©dire sur de nouvelles donn√©es ?</summary>
<div>
<p>
Le workflow est simple :
</p>
<ol>
<li>Chargez l'objet classifieur complet avec <code>loaded_clf = SpectralClassifier.load_model("path/to/model.pkl")</code>.</li>
<li>Pr√©parez vos nouvelles donn√©es sous forme d'un DataFrame <code>pandas</code> contenant les m√™mes colonnes de <em>features</em> que lors de l'entra√Ænement.</li>
<li>Faites la pr√©diction avec <code>predictions = loaded_clf.model_pipeline.predict(X_new)</code>. Le <code>model_pipeline</code> s'occupera automatiquement du scaling et de l'imputation.</li>
</ol>
</div>
</details>


<div style={{marginTop: "2rem"}}>
<Admonition type="info" title="Liens & R√©f√©rences Utiles" icon={<FontAwesomeIcon icon={faInfoCircle} />}>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" target="_blank">Documentation de <code>RandomForestClassifier</code></a></li>
<li><a href="https://joblib.readthedocs.io/en/latest/persistence.html" target="_blank">Documentation de <code>Joblib</code> pour la persistance des mod√®les</a></li>
</ul>
</Admonition>
</div>